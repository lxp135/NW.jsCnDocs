<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="刘小平">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>打开专有编解码器 - NW.js 0.35.2 中文参考文档</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u6253\u5f00\u4e13\u6709\u7f16\u89e3\u7801\u5668";
    var mkdocs_page_input_path = "For Developers\\Enable Proprietary Codecs.md";
    var mkdocs_page_url = "/For Developers/Enable Proprietary Codecs/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> NW.js 0.35.2 中文参考文档</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">首页</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">用户手册</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../For Users/Getting Started/">快速开始</a>
                </li>
                <li class="">
                    
    <a class="" href="../../For Users/Debugging with DevTools/">使用开发者工具调试</a>
                </li>
                <li class="">
                    
    <a class="" href="../../For Users/Package and Distribute/">打包与发布</a>
                </li>
                <li class="">
                    
    <a class="" href="../../For Users/FAQ/">FAQ</a>
                </li>
                <li class="">
                    
    <span class="caption-text">迁移</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Migration/From 0.12 to 0.13/">0.12升级0.13</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">进阶</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Build Flavors/">编译版本</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Content Verification/">内容验证</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Customize Menubar/">自定义菜单</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/JavaScript Contexts in NW.js/">在NW.js中使用JavaScript上下文</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Protect JavaScript Source Code/">保护JavaScript源代码</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Security in NW.js/">NW.js的安全性</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Support for Mac App Store/">提交到Mac应用商店</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Test with ChromeDriver/">使用ChromeDriver测试</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Transparent Window/">透明窗口</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Use Flash Plugin/">在NW.js中使用Flash插件</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Use NaCl in NW.js/">在NW.js中使用NaCl</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Use Native Node Modules/">在NW.js中使用原生Node.js模块</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../For Users/Advanced/Autoupdates/">自动更新</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">开发者手册</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Building NW.js/">构建 NW.js</a>
                </li>
                <li class="">
                    
    <a class="" href="../Contributing to NW.js/">为NW.js贡献代码</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">打开专有编解码器</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#enable-proprietary-codecs">Enable Proprietary Codecs</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#supported-codecs-in-prebuilt-nwjs-binary">Supported Codecs in Prebuilt NW.js Binary</a></li>
        
            <li><a class="toctree-l4" href="#enable-proprietary-codecs-in-nwjs">Enable Proprietary Codecs in NW.js</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../Repositories/">资源列表</a>
                </li>
                <li class="">
                    
    <a class="" href="../Understanding Crash Dump/">了解崩溃机制</a>
                </li>
                <li class="">
                    
    <a class="" href="../Writing Documents for NW.js/">为NW.js编写文档</a>
                </li>
                <li class="">
                    
    <a class="" href="../Writing Test Cases for NW.js/">为NW.js编写测试用例</a>
                </li>
                <li class="">
                    
    <a class="" href="../Contributors of Documents/">贡献者列表</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">参考资料</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../References/App/">App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Changes to DOM/">DOM的变化</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Changes to Node/">Node的变化</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Clipboard/">剪切板</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Command Line Options/">命令行参数</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Chrome Extension APIs/">Chrome扩展API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Manifest Format/">配置文件</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Menu/">菜单</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/MenuItem/">菜单项</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Screen/">屏幕</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Shell/">Shell</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Shortcut/">快捷键</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Tray/">系统托盘</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/webview Tag/">webview标签</a>
                </li>
                <li class="">
                    
    <a class="" href="../../References/Window/">Window</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">NW.js 0.35.2 中文参考文档</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>开发者手册 &raquo;</li>
        
      
    
    <li>打开专有编解码器</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/lxp135/NW.jsCnDocs/edit/master/docs/For Developers/Enable Proprietary Codecs.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="enable-proprietary-codecs">Enable Proprietary Codecs</h1>
<hr />
<div class="toc">
<ul>
<li><a href="#enable-proprietary-codecs">Enable Proprietary Codecs</a><ul>
<li><a href="#supported-codecs-in-prebuilt-nwjs-binary">Supported Codecs in Prebuilt NW.js Binary</a></li>
<li><a href="#enable-proprietary-codecs-in-nwjs">Enable Proprietary Codecs in NW.js</a><ul>
<li><a href="#get-ffmpeg-binaries-from-the-community">Get FFmpeg Binaries from the Community</a></li>
<li><a href="#build-ffmpeg-dll-without-building-nwjs">Build FFmpeg DLL without Building NW.js</a></li>
<li><a href="#build-entire-nwjs-with-proprietary-codecs">Build Entire NW.js with Proprietary Codecs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="supported-codecs-in-prebuilt-nwjs-binary">Supported Codecs in Prebuilt NW.js Binary</h2>
<p>As NW.js is based on Chromium, the media components are essentially the same. In the pre-built NW.js, the following codecs are supported:</p>
<pre class="codehilite"><code>- theora
- vorbis
- vp8 &amp;amp; vp9
- pcm_u8, pcm_s16le, pcm_s24le, pcm_f32le, pcm_s16be &amp;amp; pcm_s24be
- mp3 (v0.22.1+)</code></pre>


<p>&hellip; as well as these demuxers:</p>
<pre class="codehilite"><code>- ogg
- matroska
- wav</code></pre>


<h2 id="enable-proprietary-codecs-in-nwjs">Enable Proprietary Codecs in NW.js</h2>
<div class="admonition warning">
<p class="admonition-title">License and Patent Fee</p>
<p>Using the H.264 codec requires you to pay attention to the patent royalties and the license of the source code. Consult a lawyer if you do not understand the licensing constraints and using patented media formats in your application. For more information about the license of the source code, check <a href="https://chromium.googlesource.com/chromium/third_party/ffmpeg.git/+/master/CREDITS.chromium">here</a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you do <strong>NOT</strong> have the license, using this tip below or moving to other solutions does <strong>NOT</strong> make you eligible to redistribute the codecs.</p>
</div>
<h3 id="get-ffmpeg-binaries-from-the-community">Get FFmpeg Binaries from the Community</h3>
<p>In recent versions of the Chromium project, FFmpeg was changed to be built-in. So, you can&rsquo;t get the FFmpeg DLL from the official Chrome distribution anymore. However, you can get <a href="https://github.com/iteufel/nwjs-ffmpeg-prebuilt/releases">precompiled binaries</a> from the community. Another alternative would be to build FFmpeg yourself by following the instructions below.</p>
<h3 id="build-ffmpeg-dll-without-building-nwjs">Build FFmpeg DLL without Building NW.js</h3>
<p>If you are using pre-built NW.js, you can just only rebuild FFmpeg DLL and replace the bundled DLL in pre-built binaries. This will save lots of time in download size (~1G) comparing to building entire NW.js (~20G).</p>
<p><strong>Step 1.</strong> Download zip package of customized Chromium from GitHub. You can find the corresponding version in https://github.com/nwjs/chromium.src/tags. Extract the zip package into a local folder, such as <code>~/nw</code>. The unzipped package will include a sub directory. So the source folder is in <code>~/nw/&lt;sub-directory-name&gt;</code>.</p>
<p><strong>Step 2.</strong> Fetch dependencies</p>
<p>Since you are not building entire NW.js, you have to fetch following dependencies manually.</p>
<ul>
<li>Git clone following folders with corresponding commits as in <code>DEPS</code> file:<ul>
<li><code>buildtools</code></li>
<li><code>tools/gyp</code></li>
<li><code>third_party/yasm/sources/patched-yasm</code></li>
<li><code>third_party/ffmpeg</code></li>
</ul>
</li>
<li>Download <code>gn</code> tools in <code>buildtools/&lt;os&gt;</code> by</li>
</ul>
<pre class="codehilite"><code class="language-bash">download_from_google_storage --no_resume \
                             --platform=&lt;platform&gt; \
                             --no_auth \
                             --bucket chromium-gn \
                             -s buildtools/&lt;os&gt;/&lt;gn-exe&gt;.sha1</code></pre>


<pre class="codehilite"><code>- `&amp;lt;platform&amp;gt;`: `win32` for Windows; `darwin` for Mac; `linux*` for Linux
- `&amp;lt;os&amp;gt;`: `win` for Windows; `mac` for Mac; `linux64` for Linux
- `&amp;lt;gn-exe&amp;gt;`: `gn.exe` for Windows; `gn` for Mac and Linux</code></pre>


<ul>
<li><strong>[Mac and Linux]</strong> Download <code>clang</code> tools in <code>third_party/llvm-build</code> by</li>
</ul>
<pre class="codehilite"><code class="language-bash">python tools/clang/scripts/update.py --if-needed</code></pre>


<ul>
<li><strong>[Linux]</strong> Download libraries in <code>build/linux/*-sysroot</code> by</li>
</ul>
<pre class="codehilite"><code class="language-bash">python build/linux/sysroot_scripts/install-sysroot.py --running-as-hook</code></pre>


<ul>
<li><strong>[Mac]</strong> Download <strong>libc++-static</strong> library in <code>third_party/libc++-static</code> by</li>
</ul>
<pre class="codehilite"><code class="language-bash">download_from_google_storage --no_resume \
                             --platform=darwin \
                             --no_auth \
                             --bucket chromium-libcpp \
                             -s third_party/libc++-static/libc++.a.sha1</code></pre>


<div class="admonition tip">
<p class="admonition-title">For Linux Developers</p>
<p>Please run <code>build/install-build-deps.sh</code> for the first time building FFmpeg DLL or NW.js before proceeding to the instructions below. You only have to run it once. This script will install the build dependencies automatically for you.</p>
</div>
<p><strong>Step 3.</strong> Replace BUILD.gn</p>
<p>Replace <code>BUILD.gn</code> in the root of the source code with following:</p>
<pre class="codehilite"><code>action(&quot;dummy&quot;) {
  deps = [
    &quot;//third_party/ffmpeg&quot;
  ]
  script = &quot;dummy&quot;
  outputs = [&quot;$target_gen_dir/dummy.txt&quot;]
}</code></pre>


<p><strong>Step 4.</strong> Generate Ninja Files with GN Tools</p>
<pre class="codehilite"><code class="language-bash">cd path/to/nw/source/folder
gn gen //out/nw \
 --args='is_debug=false is_component_ffmpeg=true target_cpu=&quot;&lt;target_cpu&gt;&quot; is_official_build=true ffmpeg_branding=&quot;Chrome&quot;'</code></pre>


<p><strong>NOTE</strong>: <code>&lt;target_cpu&gt;</code> should be set to <code>x86</code> or <code>x64</code> for 32-bit or 64-bit build.</p>
<p><strong>Step 4.</strong> Build ffmpeg DLL</p>
<pre class="codehilite"><code class="language-bash">ninja -C out/nw ffmpeg</code></pre>


<p>You will find the DLL in <code>out/nw</code> folder. The path and file name varies between platforms:</p>
<ul>
<li>Windows: <code>ffmpeg.dll</code></li>
<li>Mac OS X: <code>libffmpeg.dylib</code></li>
<li>Linux: <code>lib/libffmpeg.so</code></li>
</ul>
<p><strong>Step 5.</strong> Replace the bundled DLL in prebuild NW.js with the one you just built. The path and file name varies between platforms:</p>
<ul>
<li>Windows: <code>ffmpeg.dll</code></li>
<li>Mac OS X: <code>nwjs.app/Contents/Versions/&lt;chromium-version&gt;/nwjs Framework.framework/libffmpeg.dylib</code></li>
<li>Linux <code>lib/libffmpeg.so</code></li>
</ul>
<h3 id="build-entire-nwjs-with-proprietary-codecs">Build Entire NW.js with Proprietary Codecs</h3>
<p>If you don&rsquo;t use official pre-built NW.js, you can build entire NW.js with proprietary codecs enabled by following the instructions below. See <a href="../Building NW.js/">Building NW.js</a> for details of each steps.</p>
<p><strong>Step 1.</strong> Install prerequists and fetch the source code of NW.js. See <em>Prerequisits</em> and <em>Get the Code</em> sections in <a href="../Building NW.js/">Building NW.js</a>.</p>
<p><strong>Step 2.</strong> Set <code>ffmpeg_branding</code> to <code>Chrome</code> when you configure GN.</p>
<p><strong>Step 3.</strong> Regenerate the ninja files again.</p>
<p><strong>Step 4.</strong> Rebuild NW.js.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Repositories/" class="btn btn-neutral float-right" title="资源列表">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Contributing to NW.js/" class="btn btn-neutral" title="为NW.js贡献代码"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>NW.js中文参考文档由<a href="https://liuxp.me">刘小平</a>提供，项目托管在<a href="https://github.com/lxp135/NW.jsCnDocs">GitHub</a>，欢迎您参与翻译。<script type="text/javascript" src="https://js.users.51.la/18564708.js"></script></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/lxp135/NW.jsCnDocs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Contributing to NW.js/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Repositories/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
